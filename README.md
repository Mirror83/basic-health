# Basic Health

The project is a simulation of a healthcare system for doctors.
The doctor (user) can register clients, and can enrol them in at least one healthcare program (which the doctor can create).

The site is hosted on [Vercel](vercel.com/) at https://basic-health.vercel.app/ with the database hosted on [Neon](https://neon.tech/).

## Built with

- [NextJS](https://nextjs.org/) (App Router) - Full-stack framework
- [PostgreSQL](https://www.postgresql.org/) - Database
- [Drizzle](https://orm.drizzle.team/docs/overview) - Database ORM
- [shadcn/ui](https://ui.shadcn.com/) - UI component library

## Setup

After cloning the project:

1. Copy the `.env.example` file to a `.env` file
   ```bash
   cp .env.example .env
   ```
2. Install dependencies
   ```bash
   pnpm install
   ```
3. The project is setup to use PostgreSQL, therefore the example DATABASE_URL value
   is a PostgreSQL database url.
   To work on this locally, if you have Postgres installed, you can setup the DB as follows
   using psql.

   ```bash
   psql -U postgres  # You can change "postgres" to your appropriate username
   CREATE DATABASE "basic-health"; # In psql
   exit; # In psql
   pnpm db:push  # To run the setup the schema
   pnpm db:seed  # To populate the db with some initial values
   ```

   You can also use a remote Postgres service like [Neon](https://neon.tech/) (It has a forgiving free tier), and use the URL generated by said service instead. Then run the schema-setup and seed steps as above.

4. Run the project development server
   ```bash
   pnpm dev
   ```

## Approach

For this project, I decided to go with an API-first approach. I believed that this would save me time, and let me work out the details of performing CRUD operations without the overhead of creating UI for each operation. I created a simple ER diagram using [Mermaid.js](https://mermaid.js.org/), a tool that lets you define diagrams using code.

![Mermaid Live Editor with ER Diagram running locally on Docker](/readme-assets/mermaid-screenshot.png)

The ER Diagram as shown depicts three entities:

1. Client
2. Program
3. ProgramClient

The first two are quite straightforward. The third entity represents the many-to-many relationship between the Client and Program (a client can be enrolled in many programs, and a program can have many clients enrolled to it). This gave me the basis of moving on to create the route handlers and Server Actions.

After creating route handlers for the various actions, I then created the UI. A couple of things to note:

- I did not use the route handlers to fetch data in the UI. This is because the route handlers are being supported by Server Actions, and therefore to avoid the overhead of a network call, I used the actions directly.
- The UI does not support any update (edit) or delete operations at the moment.
- The UI is a mess, but one can
  - [x] Create a health program â€“ e.g., TB, Malaria, HIV, etc.
  - [x] Register a new client in the system.
  - [x] Enrol a client in one or more programs.
  - [x] Search for a client from a list of registered clients. (This uses URL-based state as demonstrated [here](https://nextjs.org/learn/dashboard-app/adding-search-and-pagination))
  - [x] View a client's profile, including the programs they are enrolled in.
        The profile data can also be accessed via the endpoint: `/api/clients/{id}/profile`
- Search and pagination is supported for the `Client` objects only (where pagination is only in the corresponding action and not in the UI)
